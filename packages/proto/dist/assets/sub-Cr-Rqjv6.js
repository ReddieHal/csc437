import{d as y,b as p,H as k,R as E}from"./header-DuR1A3YQ.js";y({"ranch-cattle":E,"ranch-header":k,"mu-auth":p.Provider});k.initializeOnce();const i=document.getElementById("cattle-form");i.addEventListener("submit",async t=>{var u,m;t.preventDefault();const a=new FormData(i),e={};for(const[o,r]of a.entries())r!==null&&r!==""&&(e[o]=r);const n=["cattleId","name","breed","gender"].filter(o=>!e[o]);if(n.length>0){alert(`Please fill in all required fields: ${n.join(", ")}`);return}e.dateOfBirth&&(e.dateOfBirth=new Date(e.dateOfBirth).toISOString()),e.weight&&(e.weight=Number(e.weight)),console.log("Submitting cattle data:",e);try{const o=document.querySelector("mu-auth");let r={"Content-Type":"application/json"};(m=(u=o==null?void 0:o._context)==null?void 0:u.user)!=null&&m.authenticated&&(r.Authorization=`Bearer ${o._context.user.token}`);const l=await fetch("/api/cattle",{method:"POST",headers:r,body:JSON.stringify(e)});if(!l.ok){const d=await l.json().catch(()=>null);throw new Error((d==null?void 0:d.message)||`Error: ${l.status}`)}i.reset(),alert("Cattle added successfully!");const s=document.querySelector("ranch-cattle");if(s){const d=s.parentNode;if(d){const g=document.createElement("ranch-cattle");g.setAttribute("src","/api/cattle"),d.replaceChild(g,s)}}}catch(o){console.error("Error adding cattle:",o),alert(`Failed to add cattle: ${o.message}`)}});const f=document.querySelectorAll(".tabs button");f.forEach(t=>{t.addEventListener("click",()=>{f.forEach(e=>e.classList.remove("active")),t.classList.add("active");const a=document.querySelector("ranch-cattle");if(a){let e="/api/cattle";if(t.textContent==="Bulls")e="/api/cattle?gender=male";else if(t.textContent==="Heifers")e="/api/cattle?gender=female";else if(t.textContent==="Calves"){const n=new Date;n.setFullYear(n.getFullYear()-1),e=`/api/cattle?dateOfBirth[gte]=${n.toISOString()}`}const c=a.parentNode;if(c){const n=document.createElement("ranch-cattle");n.setAttribute("src",e),c.replaceChild(n,a)}}})});const h=document.getElementById("darkSwitch");function b(){const t=localStorage.getItem("darkMode")==="true";document.body.style.transition="none",document.body.classList.toggle("dark-mode",t),h.checked=t,document.body.offsetWidth,setTimeout(()=>{document.body.style.transition=""},10),h.closest(".dark-mode-toggle").addEventListener("change",v),document.body.addEventListener("darkmode:toggle",w)}function v(t){t.stopPropagation();const a=t.target.checked,e=new CustomEvent("darkmode:toggle",{bubbles:!0,detail:{isDarkMode:a}});document.body.dispatchEvent(e)}function w(t){const a=t.detail.isDarkMode;document.body.classList.toggle("dark-mode",a),localStorage.setItem("darkMode",a)}document.addEventListener("DOMContentLoaded",b);
